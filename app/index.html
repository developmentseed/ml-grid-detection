<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="description" content="We demonstrated the feasibility of using Skynet to detect high voltage lines at very low resolutions using a previously unused imagery band called SAR-C." />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <title>ML for Grid Detection — Developed for the World Bank Group</title>

    <!-- Twitter -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@developmentseed" />
    <meta name="twitter:title" content="ML for Grid Detection — Developed for the World Bank Group">
    <meta name="twitter:description" content="TWe demonstrated the feasibility of using Skynet to detect high voltage lines at very low resolutions using a previously unused imagery band called SAR-C." />
    <meta name="twitter:image:src" content="assets/graphics/meta/default-meta-image.png" />
    <!--/ Twitter -->

    <!-- OG -->
    <meta property="og:site_name" content="ML for Grid Detection — Developed for the World Bank Group" />
    <meta property="og:title" content="ML for Grid Detection — Developed for the World Bank Group" />
    <meta property="og:url" content="" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="We demonstrated the feasibility of using Skynet to detect high voltage lines at very low resolutions using a previously unused imagery band called SAR-C." />
    <meta property="og:image" content="assets/graphics/meta/default-meta-image.png" />
    <!--/ OG -->

    <link rel="shortcut icon" href="assets/graphics/meta/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="assets/graphics/meta/apple-touch-icon.png" />
    <link rel="apple-touch-icon" sizes="57x57" href="assets/graphics/meta/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="assets/graphics/meta/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="assets/graphics/meta/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="assets/graphics/meta/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="assets/graphics/meta/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="assets/graphics/meta/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="assets/graphics/meta/apple-touch-icon-152x152.png" />

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i" />

    <!-- build:css assets/styles/vendor.css -->
    <!-- endbuild -->

    <!-- build:css assets/styles/main.css -->
    <link rel="stylesheet" href="assets/styles/main.css" />
    <!-- endbuild -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.1.0/dist/leaflet.css"
   integrity="sha512-wcw6ts8Anuw10Mzh9Ytw4pylW8+NAD4ch3lqm9lzAsTxg0GFeJgoAtxuCLREZSC5lUXdVyo/7yfsqFjQ4S+aKw=="
   crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.1.0/dist/leaflet.js"
   integrity="sha512-mNqn2Wg7tSToJhvHcqfzLMU6J4mkOImSPTxVZAdo+lcPlk+GhZmYgACEe0x35K7YzW1zJ7XyJV/TT1MrdXvMcA=="
   crossorigin=""></script>

  </head>

  <body>

    <!-- page -->
    <div class="page page--one-pager">

      <header class="page__header" role="banner">
        <div class="inner">
          <div class="page__headline">
            <a href="/" title="Visit homepage">
              <h1 class="page__title">Machine Learning for Africa's Grid</h1>
              <p class="page__subtitle">Results of Applying Our Skynet Model</p>
            </a>
          </div>

          <nav class="page__prime-nav ppn">
            <h2 class="ppn__title"><a href="#ppn__block"><span>Menu</span></a></h2>

            <div class="ppn__block" id="ppn__block">
              <section class="ppn__section">
                <h3 class="ppn__section-title">Contents</h3>
                <ul class="ppn__menu" data-hook="nav-menu">
                  <li><a href="#title-summary" title="Jump to section" class="ppn__menu-item ppn__menu-item--active">Summary</a></li>
                  <li><a href="#title-background" title="Jump to section" class="ppn__menu-item">Background</a></li>
                  <li><a href="#title-results" title="Jump to section" class="ppn__menu-item">Results</a></li>
                  <li><a href="#title-conclusions" title="Jump to section" class="ppn__menu-item">Conclusions</a></li>
                </ul>
              </section>

            </div>
          </nav>
        </div>
      </header>

      <main class="page__body" role="main">

        <!-- inpage -->
        <section class="inpage">
          <header class="inpage__header">
            <div class="inner">
              <address class="inpage__attribution">
                <small>Developed for</small>
                <span>
                  <a href="http://www.worldbank.org/" title="Visit website">
                    <strong>World Bank Group</strong>
                    <img alt="World Bank Group logo" width="653" height="128" src="assets/graphics/content/wbg-logo-hor-col-grad.png" />
                  </a>
                </span>
              </address>
            </div>
          </header>

          <div class="inpage__body">
            <div class="inner">

              <div class="prose prose--responsive">
                <blockquote><strong>UPDATE</strong> - Read all about the updated methodology in <a href="http://devseed.com/ml-grid-docs/" target="_blank">Mapping the Electric Grid</a>.</blockquote>

                <h2 id="title-summary">Summary</h2>

                <p class="dropcap">Mapping power infrastructure - power lines and substations - is a problem that poses a unique set of challenges. Machine learning on satellite imagery is an approach that has the potential to facilitate this effort at scale, especially to map higher voltage infrastructure. This research effort assesses the feasibility of deep learning for grid detection in Non-Western areas like Sub Saharan Africa.</p>
                <p>The main take-aways at this stage are:</p>
                <ul>
                  <li><a href="https://developmentseed.org/blog/2017/01/30/machine-learning-learnings/" target="_blank">SkyNet</a> is able to detect metal pylons and high voltage lines at very low resolutions using SAR data</li>
                  <li>with SAR, the accuracy of the current model is about 75%, which we believe can be tuned to upward of 85%</li>
                  <li>a methodology relying solely on SAR does not work in mountainous areas</li>
                  <li>using optical imagery sources, SkyNet is currently not able to detect power lines, even at high resolution. We have identified new approaches that could make optical imagery work</li>
                </ul>

                <h2 id="title-background">Background</h2>

                <h3 id="">SAR-C Images </h3>

                <figure class="align-center">
                  <img src="assets/graphics/content/sentinel-1.jpg" alt="Sentinel-1 flys over Earth emmiting radio waves that capture imagery of the ground despite cloud cover" />
                </figure>
                <p>SAR-C images are captured in the same band of radio waves that wifi uses. In many respects, they are simpler to deal with than optical images - they don’t have clouds or shadows. They are also readily available under a public license. The ESA provides global SAR coverage with its Sentinel-1 constellation of satellites.</p>
                
                <p>Usually, SAR images measure  “surface roughness” (though they can also be used to measure a variety of other things, like terrain altitude). Very smooth surfaces, like desert, appear black, and rough surfaces like trees appear lighter. Somewhat rough surfaces like grass are grey.</p>
                <figure class="align-center">
                  <img src="assets/graphics/content/rainforest-desert.png" alt="In these SAR images, the desert is black with blue stripes at the tops of dunes and the rainforest is splotchy orange and yellow." />
                  <figcaption>Left: Desert, Right: Rainforest</figcaption>
                </figure>
                
                <p>SAR reflects off of artificial surfaces like concrete  and metal, making it useful for estimating population density. This property is also uniquely useful for detecting the power grid.</p> 
                <figure class="align-center">
                  <img src="assets/graphics/content/tokyo.png" alt="In this SAR image, Tokyo stands out, bright yellow against the less populated background. The densly populated downtown area is the brightest." />
                  <figcaption>Tokyo</figcaption>
                </figure>

                <p>Since many high voltage power pylons are made of steel, their glare is visible even at very low resolutions. The power grid shows clearly as rows of dots even when it is invisible in optical images.</p>
                <figure class="align-center">
                  <img src="assets/graphics/content/sar-optical.png" alt="In the SAR image, a row of yellow dots, the power lines, is clearly visible. In the optical image of the same location, there are no visible power lines." />
                  <figcaption>Left: SAR, Right: Optical<br>The images are of the same location</figcaption>
                </figure>

                <h3 id="">Machine Learning Using Satellite Images and Map Features</h3>

                <p>To detect whether a tiles has a power line in it, the computer uses a labeled dataset (tiles where it’s known for sure whether or not there’s a power line) to make a guess about whether there’s a power line in an unlabeled tile. We label the dataset using features from maps like OpenStreetMap or the Africa Grid Explorer.</p>
                <p>To make valid predictions, the computer must have a lot (thousands) of accurate labeled tiles. This approach works really well for finding streets and buildings because there are typically lots of accurate OSM features to use. It’s more challenging to use for power grid detection because power lines are a lot less common.</p>


                <h2 id="title-results">Results</h2>

                <h3 id="">Optical Images</h3>

                <p>We quickly determined that we could not use one meter resolution images to identify power lines because they usually were not visible at that resolution. Due to the availability of imagery, this eliminated training in areas besides South Africa.</p>

                <p>There, even with the best training data, power lines in low resolution optical images could not be detected. However, it is possible that this is not a fundamental limitation, but caused by our data processing. Our current data processing setup imposes several limitations which, if resolved, could make optical imagery effective at this task.</p>
                <figure class="align-center">
                  <img src="assets/graphics/content/failed-optical.png" alt="Even though the power lines are visible, the prediction is incorrect." />
                  <figcaption>Left: power lines, Right: Prediction</figcaption>
                </figure>
                <figure>
                  <div id="map-optical" style="height: 360px;"></div>
                  <figcaption>An interactive map showing an area where power lines are visible from aerial imagery.</figcaption>
                </figure>
                <p>Currently, we use an approach called semantic segmentation, where we ask the computer to “draw” the lines on the image. However, zoomed this far in, the difference between the physical location of the power line and the location reported in Africa Grid Explorer is significant. The location of the line on the image therefore uncorrelated with the “correct” answer provided by the label. The program has no information it can use to make guesses.</p>
                <p>We are working on switching to a different method, image classification, where the computer merely guesses whether or not the image container a power line. This has some disadvantages - it requires more labeled data and more data preprocessing. However, it should make it possible to use less accurate maps as labels.</p>
                <p>Another contributing factor to the lack of success in using optical images is the image file format we use. Currently, all of the satellite images we use are downloaded as JPEGs, a format reduces file size by distorting sharp edges in images. Because we are trying to detect tiny objects with sharp edges (power lines and pylons), JPEG makes them less visible.</p>
                <figure class="align-center">
                  <img src="assets/graphics/content/jpeg-issue.png" alt="The JPEG'd image has less distinct lines." />
                  <figcaption>Left: Noisy JPEG'd image, Right: Clean PNG image</figcaption>
                </figure>

                <h3 id="">SAR Images</h3>
                <p>With SAR images, we were again limited to training in South Africa. The western African countries we investigated didn't have enough label data for power lines with metal pylons. It is possible that this is because there aren't many metal pylons in these countries, or it could simply be that they haven't been recorded as throughly as in South Africa.</p>
                <p>There, about half of power lines could be accurately detected using SAR images. The success of the model was highly terrain dependent. Lines could not be detected in mountains, for example. Given that, in these situations, the lines aren’t visible to humans either, this seems to be a fundamental technical limitation of the imagery.</p> 
                <figure class="align-center">
                  <img src="assets/graphics/content/sar-prediction.png" alt="The algorithm perfectly traces a power line when it goes over smooth terain like farmland." />
                  <figcaption>Correct prediction in farmland</figcaption>
                </figure>
                <p>Other times, mountainous terrain gives false positives - the program guesses the existence of a power line where there isn’t one. This problem could be solved by preprocessing the data to remove tiles with mountains in them or by adding Landsat images as an additional input which would allow the program detect what sorts of terrain it is seeing and avoid false positives accordingly.</p>
                <figure class="align-center">
                  <img src="assets/graphics/content/false-positive.png" alt="The SAR image of mountains looks sort of like power lines, so the algorithm produces a false positive." />
                  <figcaption>False positive in mountainous areas</figcaption>
                </figure>
                <figure class="align-center">
                  <img src="assets/graphics/content/too-many-mountains.png" alt="The power lines aren't visible in the SAR image because there is so much noise from the surrounding moutnains." />
                  <figcaption>Left: SAR Image, Right: Known power line Locations</figcaption>
                </figure>
                <p>Currently, our program is about 75% accurate (for a given image, there is a 75% chance that the program correctly decided whether or not it has a power line in it). This can be tuned to favor completeness of up to 85% (i.e. 85% of images with power lines are identified as having power lines) or precision of up to 80% (i.e. 80% of images identified as having power lines actually have power lines in them).</p>
                <figure>
                  <div id="map-sar" style="height: 360px;"></div>
                  <figcaption>An interactive map showing the model's predictions in an area of South Africa with a lot of power lines</figcaption>
                </figure>

                <h2 id="title-conclusions">Conclusions</h2>
                <h3>Role of Machine Learning in Satellite Image Analysis</h3>
                <p>Currently, our model is not able to satisfactorily identify power lines from satellite images on its own. However, models like ours serve as a perfect compliment to current mapping techniques. Models like ours could be used to direct mappers on platforms like Mapswipe to areas that are most likely to have objects of interest, significantly increasing the amount of objects found with a given amount of work. OSM mappers could edit the guesses that these models make instead of tracing from scratch. To map Africa's high voltage power lines, we recommend using our model to prioritize images are tasked to human reviewers who look at each image and decide whether or not it actually contains power lines. If more detail is needed, the reviewers could trace the power lines. With more work, we hope our model will need less human input - it would trace the lines itself, the reviewer just makes small changes and approves the results.</p>

                <h3>Further Steps</h3>
                <p>Though the current solution to detecting high voltage power lines is workable, it could be significantly improved. Additionally, much of the research needed to needed to improve quality on high voltage lines could also be applied to low voltage lines.</p>
                <p>The step that will most directly improve the current model would be adding more bands of imagery to the data. If we combined SAR data with optical or near-infrared images, the model could learn which areas are mountains, forests, and cities and avoid false positives. We could also implement a image classification model, which would give less granular but potentially more accurate information about where power lines are.</p>
                <p>There are also a variety of smaller changes we could make that could significantly improve preformance. By varying things like how many images the machine learning algorithm views at once, how much weight it puts on individual wrong answers, and a host of other parameters, we could optimize our model. Given that our current parameters were already carefully tuned for optical images, there probably isn't a lot of work to be done here - but it could yield a few percentage points of improvement.</p>
                <p>We could also do more work to make optical images a viable option, like switching to from JPEG to PNG images and creating a dataset with more accurate line locations, perhaps by by manually tracing over imagery. We could also create a dataset of pylon locations. These would probably necessary steps for detecting low voltage lines.</p>
                <blockquote><strong>UPDATE</strong> - Read all about the updated methodology in <a href="http://devseed.com/ml-grid-docs/" target="_blank">Mapping the Electric Grid</a>.</blockquote>
              </div>
            </div>
          </div>

        </section>
        <!--/ inpage -->

      </main>

      <footer class="page__footer" role="contentinfo">
        <div class="inner">
          <p>
            <a href="https://developmentseed.org" title="Visit Development Seed website"><img src="../assets/graphics/layout/devseed-logo-symbol.svg" alt="Development Seed logo symbol" width="512" height="152" /> <span>Development Seed</span></a>
            <small>2017</small>
          </p>
        </div>
      </footer>

    </div>
    <!--/ page -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-65674-2', 'auto');
      ga('send', 'pageview');

    </script>
    <script>
      var mymap = L.map('map-sar', {zoomControl:false, minZoom:12}).setView([-30.1, 26.5], 12);
      L.tileLayer('https://tiles-b.descarteslabs.com/xyz/sentinel-1_v2/vv_2014-2017/{z}/{x}/{y}/tile.jpeg?={accessToken}', { accessToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc19hbm9uIjpmYWxzZSwic3ViIjoiZ29vZ2xlLW9hdXRoMnwxMTAyMTc0MjAwODgyNjY1MDgxODUiLCJpc3MiOiJodHRwczovL2Rlc2NhcnRlc2xhYnMuYXV0aDAuY29tLyIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJuYW1lIjoiRWxpIExpdHdhY2siLCJncm91cHMiOlsicHVibGljIiwiYmV0YSJdLCJpYXQiOjE0OTk3NzcxMDEsImV4cCI6MTQ5OTgxMzEwMSwiZW1haWwiOiJlbGlAZGV2ZWxvcG1lbnRzZWVkLm9yZyIsImF1ZCI6IlpPQkFpNFVST2w1Z0taSXB4eGx3T0VmeDhLcHFYZjJjIn0._lHYsjFYFy45o1n9svOgPKmBB95PPya_IsYrszDCKwY', maxZoom: 12}).addTo(mymap);
      L.tileLayer('https://s3.amazonaws.com/ds-skynet-power/mixed-lr-test-worldwide-20k-iter/{z}/{x}/{y}.png', {maxZoom: 12,  opacity: .5}).addTo(mymap);

      var opticalmap = L.map('map-optical', {zoomControl:true, minZoom:10}).setView([-30.1 + .08, 26.5 - .14], 17);
      L.tileLayer('http://a.aerial.openstreetmap.org.za/ngi-aerial/{z}/{x}/{y}.jpg', {maxZoom: 20}).addTo(opticalmap);
    </script>

    <!-- build:js assets/scripts/vendor.js -->
    <script src="assets/scripts/vendor.js"></script>
    <!-- endbuild -->
    <!-- build:js assets/scripts/bundle.js -->
    <script src="assets/scripts/bundle.js"></script>
    <!-- endbuild -->
  </body>
</html>
