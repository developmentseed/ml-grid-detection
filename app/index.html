<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="description" content="Testing UI Seed." />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <title>ML for Grid Detection — Development Seed</title>

    <!-- Twitter -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@developmentseed" />
    <meta name="twitter:title" content="ML for Grid Detection — Development Seed">
    <meta name="twitter:description" content="TWe demonstrated the feasibility of using Skynet to detect high voltage lines at very low resolutions using a previously unused imagery band called SAR-C." />
    <meta name="twitter:image:src" content="assets/graphics/meta/default-meta-image.png" />
    <!--/ Twitter -->

    <!-- OG -->
    <meta property="og:site_name" content="ML for Grid Detection — Development Seed" />
    <meta property="og:title" content="ML for Grid Detection — Development Seed" />
    <meta property="og:url" content="" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="We demonstrated the feasibility of using Skynet to detect high voltage lines at very low resolutions using a previously unused imagery band called SAR-C." />
    <meta property="og:image" content="assets/graphics/meta/default-meta-image.png" />
    <!--/ OG -->

    <link rel="shortcut icon" href="assets/graphics/meta/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="assets/graphics/meta/apple-touch-icon.png" />
    <link rel="apple-touch-icon" sizes="57x57" href="assets/graphics/meta/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="assets/graphics/meta/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="assets/graphics/meta/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="assets/graphics/meta/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="assets/graphics/meta/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="assets/graphics/meta/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="assets/graphics/meta/apple-touch-icon-152x152.png" />

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i" />

    <!-- build:css assets/styles/vendor.css -->
    <!-- endbuild -->

    <!-- build:css assets/styles/main.css -->
    <link rel="stylesheet" href="assets/styles/main.css" />
    <!-- endbuild -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.1.0/dist/leaflet.css"
   integrity="sha512-wcw6ts8Anuw10Mzh9Ytw4pylW8+NAD4ch3lqm9lzAsTxg0GFeJgoAtxuCLREZSC5lUXdVyo/7yfsqFjQ4S+aKw=="
   crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.1.0/dist/leaflet.js"
   integrity="sha512-mNqn2Wg7tSToJhvHcqfzLMU6J4mkOImSPTxVZAdo+lcPlk+GhZmYgACEe0x35K7YzW1zJ7XyJV/TT1MrdXvMcA=="
   crossorigin=""></script>

  </head>

  <body>

    <!-- page -->
    <div class="page page--one-pager">

      <header class="page__header" role="banner">
        <div class="inner">
          <div class="page__headline">
            <a href="/" title="Visit homepage">
              <h1 class="page__title">Machine Learning for Africa's Grid</h1>
              <p class="page__subtitle">Results of Applying Our Skynet Model</p>
            </a>
          </div>

          <nav class="page__prime-nav ppn">
            <h2 class="ppn__title"><a href="#ppn__block"><span>Menu</span></a></h2>

            <div class="ppn__block" id="ppn__block">
              <section class="ppn__section">
                <h3 class="ppn__section-title">Contents</h3>
                <ul class="ppn__menu" data-hook="nav-menu">
                  <li><a href="#title-summary" title="Jump to section" class="ppn__menu-item ppn__menu-item--active">Summary</a></li>
                  <li><a href="#title-background" title="Jump to section" class="ppn__menu-item">Background</a></li>
                  <li><a href="#title-results" title="Jump to section" class="ppn__menu-item">Results</a></li>
                  <li><a href="#title-conclusions" title="Jump to section" class="ppn__menu-item">Conclusions</a></li>
                </ul>
              </section>

            </div>
          </nav>
        </div>
      </header>

      <main class="page__body" role="main">

        <!-- inpage -->
        <section class="inpage">
          <header class="inpage__header">
            <div class="inner">
              <div class="inpage__headline">
                <p class="inpage__subtitle">Section title</p>
                <h1 class="inpage__title">Page title</h1>
              </div>
            </div>
          </header>

          <div class="inpage__body">
            <div class="inner">

              <div class="prose prose--responsive">

                <h2 id="title-summary">Summary</h2>

                <p class="dropcap">We demonstrated the feasibility of using Skynet to detect high voltage lines at very low resolutions using a previously unused imagery band called SAR-C. We also demonstrated that readily available optical imagery sources with existing training data, even at the highest resolutions, cannot detect power lines. However, we identified several new approaches methods that could make optical imagery workable.</p>

                <h2 id="title-background">Background</h2>

                <h3 id="">SAR-C Images </h3>

                <figure class="align-center">
                  <img src="assets/graphics/content/sentinel-1.jpg" alt="Sentinel-1 flys over Earth emmiting radio waves that capture imagery of the ground despite cloud cover" />
                </figure>
                <p>SAR-C images are captured in the same band of radio waves that wifi uses. In many respects, they are simpler to deal with than optical images - they don’t have clouds or shadows. They are also readily available. The ESA provides global SAR coverage with it’s Sentinel-1 constellation of satellites.</p>
                
                <p>Usually, SAR images measure  “surface roughness” (though they can also be used to measure a variety of other things, like terrain altitude). Very smooth surfaces, like desert, appear black, and rough surfaces like trees appear lighter. Somewhat rough surfaces like grass are grey.</p>
                <figure class="align-center">
                  <img src="assets/graphics/content/rainforest-desert.png" alt="In these SAR images, the desert is black with blue stripes at the tops of dunes and the rainforest is splotchy orange and yellow." />
                  <figcaption>Left: Desert, Right: Rainforest</figcaption>
                </figure>
                
                <p>SAR reflects off of artificial surfaces like concrete  and metal, making it useful for estimating population density. This property is also uniquely useful for detecting the power grid.</p> 
                <figure class="align-center">
                  <img src="assets/graphics/content/tokyo.png" alt="In this SAR image, Tokyo stands out, bright yellow against the less populated background. The densly populated downtown area is the brightest." />
                  <figcaption>Tokyo</figcaption>
                </figure>

                <p>Since many high voltage power pylons are made of steel, their glare is visible even at very low resolutions. The power grid shows clearly as rows of dots even when it is invisible in optical images.</p>
                <figure class="align-center">
                  <img src="assets/graphics/content/sar-optical.png" alt="In the SAR image, a row of yellow dots, the powerlines, is clearly visible. In the optical image of the same location, there are no visible powerlines." />
                  <figcaption>Left: SAR, Right: Optical<br>The images are of the same location</figcaption>
                </figure>

                <h3 id="">Machine Learning Using Satellite Images and Map Features</h3>

                <p>To detect whether a tiles has a power line in it, the computer uses a labeled dataset (tiles where it’s known for sure whether or not there’s a powerline) to make a guess about whether there’s a powerline in an unlabeled tile. We label the dataset using features from maps like OpenStreetMap or the Africa Grid Explorer.</p>
                <p>To make valid predictions, the computer must have a lot (thousands) of accurate labeled tiles. This approach works really well for finding streets and buildings because there are typically lots of accurate OSM features to use. It’s more challenging to use for power grid detection because powerlines are a lot less common.</p>


                <h2 id="title-results">Results</h2>

                <h3 id="">Optical Images</h3>

                <p>We quickly determined that we could not use one meter resolution images to identify powerlines because they usually were not visible at that resolution. Due to the availability of imagery, this eliminated training in areas besides South Africa.</p>

                <p>There, even with the best training data, powerlines in low resolution optical images could not be detected. However, it is possible that this is not a fundamental limitation, but caused by our data processing. Our current data processing setup imposes several limitations which, if resolved, could make optical imagery effective at this task.</p>
                <figure class="align-center">
                  <img src="assets/graphics/content/failed-optical.png" alt="Even though the powerlines are visible, the prediction is incorrect." />
                  <figcaption>Left: Powerlines, Right: Prediction</figcaption>
                </figure>
                <p>Currently, we use an approach called semantic segmentation, where we ask the computer to “draw” the lines on the image. However, zoomed this far in, the difference between the physical location of the powerline and the location reported in Africa Grid Explorer is significant. The location of the line on the image therefore uncorrelated with the “correct” answer provided by the label. The program has no information it can use to make guesses.</p>
                <p>We are working on switching to a different method, image classification, where the computer merely guesses whether or not the image container a power line. This has some disadvantages - it requires more labeled data and more data preprocessing. However, it should make it possible to use less accurate maps as labels.</p>
                <p>Another contributing factor to the lack of success in using optical images is the image file format we use. Currently, all of the satellite images we use are downloaded as JPEGs, a format reduces file size by distorting sharp edges in images. Because we are trying to detect tiny objects with sharp edges (powerlines and pylons), JPEG makes them less visible.</p>
                <figure class="align-center">
                  <img src="assets/graphics/content/jpeg-issue.png" alt="The JPEG'd image has less distinct lines." />
                  <figcaption>Left: Noisy JPEG'd image, Right: Clean PNG image</figcaption>
                </figure>

                <h3 id="">SAR Images</h3>
                <p>With SAR images, we were again limited to training in South Africa. The western African countries we investigated didn't have enough label data for powerlines with metal pylons. It is possible that this is because there aren't many metal pylons in these countries, or it could simply be that they haven't been recorded as throughly as in South Africa.</p>
                <p>There, about half of power lines could be accurately detected using SAR images. The success of the model was highly terrain dependent. Lines could not be detected in mountains, for example. Given that, in these situations, the lines aren’t visible to humans either, this seems to be a fundamental technical limitation of the imagery.</p> 
                <figure class="align-center">
                  <img src="assets/graphics/content/sar-prediction.png" alt="The algorithm perfectly traces a powerline when it goes over smooth terain like farmland." />
                  <figcaption>Correct prediction in farmland</figcaption>
                </figure>
                <p>Other times, mountainous terrain gives false positives - the program guesses the existence of a powerline where there isn’t one. This problem could be solved by preprocessing the data to remove tiles with mountains in them or by adding Landsat images as an additional input which would allow the program detect what sorts of terrain it is seeing and avoid false positives accordingly.</p>
                <figure class="align-center">
                  <img src="assets/graphics/content/false-positive.png" alt="The SAR image of mountains looks sort of like powerlines, so the algorithm produces a false positive." />
                  <figcaption>False positive in mountainous aread</figcaption>
                </figure>
                <figure class="align-center">
                  <img src="assets/graphics/content/too-many-mountains.png" alt="The powerlines aren't visible in the SAR image because there is so much noise from the surrounding moutnains." />
                  <figcaption>Left: SAR Image, Right: Known Powerline Locations</figcaption>
                </figure>
                <p>Currently, our program is about 75% accurate (for a given image, there is a 75% chance that the program correctly decided whether or not it has a powerline in it). This can be tuned to favor completeness of up to 85% (i.e. 85% of images with powerlines are identified as having power lines) or precision of up to 80% (i.e. 80% of images identified as having power lines actually have power lines in them).</p>
                <figure>
                  <div id="map" style="height: 360px;"></div>
                  <figcaption>An interactive map showing the model's predictions in an area of South Africa with a lot of powerlines</figcaption>
                </figure>

                <h2 id="title-conclusions">Conclusions</h2>

                <h3>Feasability</h3>
                <p>The current SAR model, if used in conjunction with human reviewers, would provide a feasible option for mapping Africa's high voltage power infrastructure. Given our model's accuracy and recall, it would narrow the area of Africa that might contain high voltage powerlines down to 160,000 zoom level 12 tiles, which could be verified on a program like Mapswipe with around 150 person hours. Total server costs for processing every tile in Africa would be about $275.</p>

                <h3>Further Steps</h3>

                <p>Given that it is currently feasible to search all of Africa for high voltage pylons, future research should focus detecting low voltage pylons. We identified several next steps that could be taken to attempt to identify low voltage pylons:</p>
                <ul>•Impliment an image classification model</ul>
                <ul>•Switch to png image sources</ul>
                <ul>•Recreate powerline dataset, dr</ul>
                <ul>•Create a dataset with pylon locations as opposed to line locations (will require some manual labeling)</ul>
                <ul>•Experiement with diffrent techinques (larger tile sizes, diffrent models) that allow the model to use lines as labels even when only pylons are visible</ul>

                <p> To improve high voltage line detection preformance, we could combine imagery from multiple sources (ie. SAR, infared, and optical) to so that the model can identify mountains reduce false positives. The infrastructure to do this would be useful for other tasks, </p>
              </div>
            
            </div>
          </div>

        </section>
        <!--/ inpage -->

      </main>

      <footer class="page__footer" role="contentinfo">
        <div class="inner">
          <p>
            <a href="https://developmentseed.org" title="Visit Development Seed website"><img src="../assets/graphics/layout/devseed-logo-symbol.svg" alt="Development Seed logo symbol" width="512" height="152" /> <span>Development Seed</span></a>
            <small>2017</small>
          </p>
        </div>
      </footer>

    </div>
    <!--/ page -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-65674-2', 'auto');
      ga('send', 'pageview');

    </script>
    <script>
      //var mymap = L.map('map', {zoomControl:false, minZoom:12}).setView([-30.1, 26.5], 12);
      var mymap = L.map('map', {zoomControl:true}).setView([-30.1, 26.5], 12);
      //L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/light-v9/tiles/256/{z}/{x}/{y}?access_token={accessToken}', {attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>', accessToken: 'pk.eyJ1IjoiZGV2c2VlZCIsImEiOiJnUi1mbkVvIn0.018aLhX0Mb0tdtaT2QNe2Q', maxZoom: 12}).addTo(mymap);
      L.tileLayer('https://tiles-b.descarteslabs.com/xyz/sentinel-1_v2/vv_2014-2017/{z}/{x}/{y}/tile.jpeg?={accessToken}', { accessToken: 'Our-DL-Token', maxZoom: 12}).addTo(mymap);
      L.tileLayer('https://s3.amazonaws.com/ds-skynet-power/mixed-lr-test-worldwide-20k-iter/{z}/{x}/{y}.png', {maxZoom: 12,  opacity: .5}).addTo(mymap);
    </script>

    <!-- build:js assets/scripts/vendor.js -->
    <script src="assets/scripts/vendor.js"></script>
    <!-- endbuild -->
    <!-- build:js assets/scripts/bundle.js -->
    <script src="assets/scripts/bundle.js"></script>
    <!-- endbuild -->
  </body>
</html>